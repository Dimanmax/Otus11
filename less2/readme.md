# Лабораторная работа. Базовая настройка коммутатора

## Топология



 [![](https://github.com/Dimanmax/Otus11/blob/main/less2/%D1%82%D0%BE%D0%BF%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D1%8F%20%D0%B8%D0%B7%20%D0%B7%D0%B0%D0%B4%D0%B0%D0%BD%D0%B8%D1%8F.jpg)](https://github.com/Dimanmax/Otus11/blob/main/less2/%D1%82%D0%BE%D0%BF%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D1%8F%20%D0%B8%D0%B7%20%D0%B7%D0%B0%D0%B4%D0%B0%D0%BD%D0%B8%D1%8F.jpg)
 
 ## Таблица адресации
 
[![](https://github.com/Dimanmax/Otus11/blob/main/less2/%D1%82%D0%B0%D0%B1%D0%BB%D0%B8%D1%86%D0%B0_%D0%B0%D0%B4%D1%80%D0%B5%D1%81%D0%B0%D1%86%D0%B8%D0%B8.png)](https://github.com/Dimanmax/Otus11/blob/main/less2/%D1%82%D0%B0%D0%B1%D0%BB%D0%B8%D1%86%D0%B0_%D0%B0%D0%B4%D1%80%D0%B5%D1%81%D0%B0%D1%86%D0%B8%D0%B8.png)

## Задачи

### Часть 1. Проверка конфигурации коммутатора по умолчанию

### Часть 2. Создание сети и настройка основных параметров устройства

•	Настройте базовые параметры коммутатора.
•	Настройте IP-адрес для ПК.

### Часть 3. Проверка сетевых подключений

•	Отобразите конфигурацию устройства.

•	Протестируйте сквозное соединение, отправив эхо-запрос.

•	Протестируйте возможности удаленного управления с помощью Telnet.

## Общие сведения/сценарий

На коммутаторах Cisco можно настроить особый IP-адрес, который называют виртуальным интерфейсом коммутатора (SVI). SVI или адрес управления можно использовать для удаленного доступа к коммутатору в целях отображения или настройки параметров. Если для SVI сети VLAN 1 назначен IP-адрес, то по умолчанию все порты в сети VLAN 1 имеют доступ к IP-адресу управления SVI. 

В ходе данной лабораторной работы вам предстоит построить простую топологию, используя Ethernet-кабель локальной сети, и получить доступ к коммутатору Cisco, используя консольное подключение и методы удаленного доступа. Перед настройкой базовых параметров коммутатора нужно проверить настройки коммутатора по умолчанию. В число таких основных параметров коммутации входят имя устройства, описание интерфейса, локальные пароли, объявление дня (MOTD), IP-адрес и статический MAC-адрес. Необходимо также показать использование IP-адреса управления для удаленного управления коммутатором. Топология включает один коммутатор и один узел с использованием только портов Ethernet и консольных портов.

**Примечание.** В лабораторной работе используются коммутаторы Cisco Catalyst 2960s с операционной системой Cisco IOS 15.2(2) (образ lanbasek9). Допускается использование других моделей коммутаторов и других версий Cisco IOS. В зависимости от модели устройства и версии Cisco IOS доступные команды и результаты их выполнения могут отличаться от тех, которые показаны в лабораторных работах. 

**Примечание:** Убедитесь, что все настройки коммутатора удалены и загрузочная конфигурация отсутствует. Если вы не уверены, обратитесь к инструктору. Процедура инициализации и перезагрузки коммутатора описана в приложении А.


### Часть 1. Создание сети и проверка настроек коммутатора по умолчанию

В первой части лабораторной работы вам предстоит настроить топологию сети и проверить настройку коммутатора по умолчанию.


#### Шаг 1. Создайте сеть согласно топологии.

a. Подсоедините консольный кабель, как показано в топологии. На данном этапе не подключайте кабель Ethernet компьютера PC-A.
**Примечание.** При использовании Netlab отключите интерфейс F0/6 на коммутаторе S1. Это имеет такой же эффект, как отсоединение компьютера PC-A от коммутатора S1.
b. Установите консольное подключение к коммутатору с компьютера PC-A с помощью Tera Term или другой программы эмуляции терминала.
Вопрос:

Почему нужно использовать консольное подключение для первоначальной настройки коммутатора?

**Ответ При дефолтной конфигурации коммутатора - отсутствует доступ по обоим протоколам, необходимо предаварительно настроить.**


Почему нельзя подключиться к коммутатору через Telnet или SSH?

**Ответ Необходима первичная настройка для предоставления дальнешего доступа.**



#### Шаг 2. Проверьте настройки коммутатора по умолчанию.

На данном этапе вам нужно проверить такие параметры коммутатора по умолчанию, как текущие настройки коммутатора, данные IOS, свойства интерфейса, сведения о VLAN и флеш-память.
Все команды IOS коммутатора можно выполнять из привилегированного режима. Доступ к привилегированному режиму нужно ограничить с помощью пароля, чтобы предотвратить неавторизованное использование устройства — через этот режим можно получить прямой доступ к режиму глобальной конфигурации и командам, используемым для настройки рабочих параметров. Пароли можно будет настроить чуть позже.
К привилегированному набору команд относятся команды пользовательского режима, а также команда **configure**, при помощи которой выполняется доступ к остальным командным режимам. Введите команду **enable**, чтобы войти в привилегированный режим EXEC.

a. Предположим, что коммутатор не имеет файла конфигурации, сохраненного в энергонезависимой памяти (NVRAM). Консольное подключение к коммутатору с помощью Tera Term или другой программы эмуляции терминала предоставит доступ к командной строке пользовательского режима EXEC в виде Switch>. Введите команду **enable**, чтобы войти в привилегированный режим EXEC.
Откройте окно конфигурации
Обратите внимание, что измененная в конфигурации строка будет отражать привилегированный режим EXEC.
Убедитесь, что на коммутаторе находится пустой файл конфигурации по умолчанию, с помощью команды show running-config привилегированного режима EXEC. 
Если конфигурационный файл был предварительно сохранен, его нужно удалить. В зависимости от модели коммутатора и версии IOS ваша конфигурация может слегка отличаться. Тем не менее, настроенных паролей или IP-адресов в конфигурации быть не должно. Выполните очистку настроек и перезагрузите коммутатор, если ваш коммутатор имеет настройки, отличные от настроек по умолчанию.

b. 	Изучите текущий файл running configuration.
Вопросы:
Сколько интерфейсов FastEthernet имеется на коммутаторе 2960?

**Ответ 24 - FastEthernet**

Сколько интерфейсов Gigabit Ethernet имеется на коммутаторе 2960?

**Ответ  2 - GigabitEthernet**

Каков диапазон значений, отображаемых в vty-линиях?

**Ответ  0 -15**

Вопросы:
Под управлением какой версии ОС Cisco IOS работает коммутатор?

**Ответ  SW Version 15.0(2)SE4**

Как называется файл образа системы?

**Ответ SW Image - C2960-LANBASEK9-M**

Вопрос:

Интерфейс включен или выключен?

**по дефолту выкл, надо включать самому.**

Что нужно сделать, чтобы включить интерфейс?

 **Ответ через команду no sh находясь на самом интерфейсе.**
 
Какой MAC-адрес у интерфейса?

**Ответ  0001.c9ba.9106**

Какие настройки скорости и дуплекса заданы в интерфейсе?

**Ответ Full-duplex, 100Mb/s**

i.	Изучите флеш-память.
Выполните одну из следующих команд, чтобы изучить содержимое флеш-каталога.
```
Switch# show flash 
Switch# dir flash:
``` 
В конце имени файла указано расширение, например .bin. Каталоги не имеют расширения файла.

Вопрос:

Какое имя присвоено образу Cisco IOS?

**Ответ 2960-lanbasek9-mz.150-2.SE4.bin**

### Часть 2. Настройка базовых параметров сетевых устройств
Во второй части необходимо будет настроить основные параметры коммутатора и компьютера.

#### Шаг 1. Настройте базовые параметры коммутатора.
a.	В режиме глобальной конфигурации скопируйте следующие базовые параметры конфигурации и вставьте их в файл на коммутаторе S1. 
```
no ip domain-lookup
hostname S1
service password-encryption
enable secret class
banner motd #
Unauthorized access is strictly prohibited. #

```
b.	Назначьте IP-адрес интерфейсу SVI на коммутаторе. Благодаря этому вы получите возможность удаленного управления коммутатором.
Прежде чем вы сможете управлять коммутатором S1 удаленно с компьютера PC-A, коммутатору нужно назначить IP-адрес. Согласно конфигурации по умолчанию коммутатором можно управлять через VLAN 1.
c.	Доступ через порт консоли также следует ограничить  с помощью пароля. Используйте cisco в качестве пароля для входа в консоль в этом задании. Конфигурация по умолчанию разрешает все консольные подключения без пароля. Чтобы консольные сообщения не прерывали выполнение команд, используйте параметр **logging synchronous.**
```
S1(config)# line con 0
S1(config-line)# logging synchronous 
```
d.	Настройте каналы виртуального соединения для удаленного управления (vty), чтобы коммутатор разрешил доступ через Telnet. Если не настроить пароль VTY, будет невозможно подключиться к коммутатору по протоколу Telnet.
Вопрос:
Для чего нужна команда **login**?

#### Шаг 2. Настройте IP-адрес на компьютере PC-A.

Назначьте компьютеру IP-адрес и маску подсети в соответствии с таблицей адресации.

1)	Перейдите в **Панель управления**. (Control Panel)
2)	В представлении «Категория» выберите « **Просмотр состояния сети и задач**».
3)	Щелкните **Изменение параметров адаптера на левой панели**.
4)	Щелкните правой кнопкой мыши интерфейс **Ethernet** и выберите «**Свойства**» .
5)	Выберите **Протокол Интернета версии 4 (TCP/IPv4)** > **Свойства**.
6)	Выберите **Использовать следующий IP-адрес** и введите IP-адрес и маску подсети  и нажмите **ОК**.


#### Шаг 1. Отобразите конфигурацию коммутатора.

Используйте консольное подключение на компьютере PC-A для отображения и проверки конфигурации коммутатора. Команда **show run** позволяет постранично отобразить всю текущую конфигурацию. Для пролистывания используйте клавишу пробела.
a.	Пример конфигурации приведен ниже. Параметры, которые вы настроили, выделены желтым. Другие параметры конфигурации — значения IOS по умолчанию.

Откройте окно конфигурации
`CLI коммутатора`

```

S1# show run
Building configuration...

Current configuration : 2206 bytes
!
version 15.2
no service pad
service timestamps debug datetime msec
service timestamps log datetime msec
service password-encryption
!
hostname S1
!
boot-start-marker
boot-end-marker
!
enable secret 5 $1$mtvC$6NC.1VKr3p6bj7YGE.jNg0
!
no aaa new-model
system mtu routing 1500 
!
!
no ip domain-lookup
!
<output omitted>
!
interface FastEthernet0/24
!
interface GigabitEthernet0/1
!
interface GigabitEthernet0/2
!
interface Vlan1
 ip address 192.168.1.2 255.255.255.0
!
ip default-gateway 192.168.1.1
ip http server
ip http secure-server
!
banner motd ^C
Unauthorized access is strictly prohibited. ^C
!
line con 0
 password 7 00071A150754
 logging synchronous
 login
line vty 0 4
 password 7 121A0C041104
 login
line vty 5 15
 password 7 121A0C041104
 login
!
end

```
b.	Проверьте параметры VLAN 1.

S1# show interface vlan 1 



#### Шаг 3. Проверьте удаленное управление коммутатором S1.
После этого используйте удаленный доступ к устройству с помощью Telnet. В этой лабораторной работе устройства PC-A и S1 расположены рядом. В производственной сети коммутатор может находиться в коммутационном шкафу на последнем этаже, в то время как административный компьютер находится на первом этаже. На данном этапе вам предстоит использовать Telnet для удаленного доступа к коммутатору S1 через его административный адрес SVI. Telnet — это не безопасный протокол, но вы можете использовать его для проверки удаленного доступа. В случае с Telnet вся информация, включая пароли и команды, отправляется через сеанс в незашифрованном виде. В последующих лабораторных работах вы будете использовать протокол SSH для удаленного доступа к сетевым устройствам.

a.	Откройте Tera Term или другую программу эмуляции терминала с возможностью Telnet. 

b.	Выберите сервер Telnet и укажите адрес управления SVI для подключения к S1.  Пароль: **cisco**.

c.	После ввода пароля cisco вы окажетесь в командной строке пользовательского режима. Для перехода в исполнительский режим EXEC введите команду **enable** и используйте секретный пароль **class**.

d.	Сохраните конфигурацию.

e.	Чтобы завершить сеанс Telnet, введите **exit**.





# Решение

### Часть 1. Проверка конфигурации коммутатора по умолчанию

Ответы даны выше, в самом теле задания.


### Часть 2. Настройка базовых параметров сетевых устройств
Во второй части необходимо будет настроить основные параметры коммутатора и компьютера.

#### Шаг 1. Настройте базовые параметры коммутатора.

Приступил к первичной настройке коммутатора:

Скрин 1

[![](https://github.com/Dimanmax/Otus11/blob/main/less2/1.png)](https://github.com/Dimanmax/Otus11/blob/main/less2/1.png)

Скрин2

[![](https://github.com/Dimanmax/Otus11/blob/main/less2/2.png)](https://github.com/Dimanmax/Otus11/blob/main/less2/2.png)

Скрин3

[![](https://github.com/Dimanmax/Otus11/blob/main/less2/2.png)](https://github.com/Dimanmax/Otus11/blob/main/less2/2.png)


Далее ограничим доступ к vty линиям с 0 по 5

Скрин 

[![](https://github.com/Dimanmax/Otus11/blob/main/less2/3.png)](https://github.com/Dimanmax/Otus11/blob/main/less2/3.png)

Сохраняем изменения

[![](https://github.com/Dimanmax/Otus11/blob/main/less2/5.png)](https://github.com/Dimanmax/Otus11/blob/main/less2/5.png)

Ребутаемся и проверяем изменения

[![](https://github.com/Dimanmax/Otus11/blob/main/less2/6.png)](https://github.com/Dimanmax/Otus11/blob/main/less2/6.png)

Как видим, пароль на вход уже установлен, также стоит банер

[![](https://github.com/Dimanmax/Otus11/blob/main/less2/7.png)](https://github.com/Dimanmax/Otus11/blob/main/less2/7.png)

Настроим SVI На коммутаторе:

[![](https://github.com/Dimanmax/Otus11/blob/main/less2/8.png)](https://github.com/Dimanmax/Otus11/blob/main/less2/8.png)


#### Шаг 2. Настройте IP-адрес на компьютере PC-A.

Настроил IP на Компьютере PC-A

[![](https://github.com/Dimanmax/Otus11/blob/main/less2/10.png)](https://github.com/Dimanmax/Otus11/blob/main/less2/10.png)



Пинг с ПК до коммутатора и обратно есть

[![](https://github.com/Dimanmax/Otus11/blob/main/less2/11.png)](https://github.com/Dimanmax/Otus11/blob/main/less2/11.png)
[![](https://github.com/Dimanmax/Otus11/blob/main/less2/12.png)](https://github.com/Dimanmax/Otus11/blob/main/less2/12.png)






#### Шаг 3. Проверьте удаленное управление коммутатором S1.
Проверим подключение по телнет с ПК

[![](https://github.com/Dimanmax/Otus11/blob/main/less2/13.png)](https://github.com/Dimanmax/Otus11/blob/main/less2/13.png)
